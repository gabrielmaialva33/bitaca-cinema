<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Bitaca Play - Plataforma de streaming de animes e filmes" name="description">
    <meta content="anime, streaming, filmes, s√©ries, entretenimento" name="keywords">

    <!-- Open Graph -->
    <meta content="Bitaca Play - Streaming de Animes e Filmes" property="og:title">
    <meta content="Assista milhares de animes, filmes e s√©ries online gratuitamente" property="og:description">
    <meta content="website" property="og:type">
    <meta content="assets/images/og-play.png" property="og:image">

    <!-- Theme -->
    <meta content="#C41E3A" name="theme-color">

    <title>Bitaca Play | Streaming de Animes e Filmes</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Staatliches&family=Pacifico&display=swap" rel="stylesheet">

    <!-- KeenIcons (Metronic) -->
    <link href="assets/vendors/keenicons/styles.bundle.css" rel="stylesheet">

    <!-- Custom Play CSS -->
    <link href="assets/css/play.css" rel="stylesheet">
</head>
<body>

<!-- Navigation -->
<nav class="navbar" id="navbar">
    <div class="navbar-container">
        <div class="navbar-brand">
            <a href="#" class="logo">
                <svg height="50" viewBox="0 0 200 80" width="50">
                    <!-- Casinha -->
                    <polygon fill="#C41E3A" points="100,10 120,25 120,40 80,40 80,25" stroke="#0A0A0A" stroke-width="2"/>
                    <rect fill="#8B4513" height="12" width="8" x="90" y="28"/>
                    <rect fill="#8B4513" height="12" width="8" x="105" y="28"/>
                    <!-- Folhagens -->
                    <path d="M 70,30 Q 65,25 70,20" fill="none" stroke="#2D5016" stroke-width="3"/>
                    <path d="M 130,30 Q 135,25 130,20" fill="none" stroke="#2D5016" stroke-width="3"/>
                    <!-- Texto BITACA -->
                    <text fill="#C41E3A" font-family="Staatliches, sans-serif" font-size="28" font-weight="bold" x="40" y="65">BITACA</text>
                    <text fill="#0A0A0A" font-family="Pacifico, cursive" font-size="14" x="60" y="78">Play</text>
                </svg>
            </a>
            <span class="brand-text">PLAY</span>
        </div>

        <div class="navbar-menu">
            <a class="nav-link active" href="#home">In√≠cio</a>
            <a class="nav-link" href="#animes">Animes</a>
            <a class="nav-link" href="#filmes">Filmes</a>
            <a class="nav-link" href="#series">S√©ries</a>
        </div>

        <div class="navbar-actions">
            <button aria-label="Buscar produ√ß√µes" class="btn-icon" id="search-btn" title="Buscar">
                <i class="ki-filled ki-magnifier"></i>
            </button>
            <button aria-label="Modo 3D" class="btn-icon" id="3d-btn" title="Visualiza√ß√£o 3D">
                <i class="ki-filled ki-cube-3d"></i>
            </button>
            <button aria-label="Sair" class="btn-icon" id="logout-btn" title="Sair">
                <i class="ki-filled ki-exit-right"></i>
            </button>
            <button aria-label="Menu mobile" class="btn-icon mobile-menu-btn" id="mobile-menu-btn">
                <i class="ki-filled ki-burger-menu"></i>
            </button>
        </div>
    </div>
</nav>

<!-- Main Container -->
<div class="main-container">
    <!-- Content Area -->
    <main class="content-area">
        <!-- Hero Banner -->
        <section class="hero-banner">
            <div class="hero-gradient"></div>
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        <i class="ki-filled ki-picture"></i> Streaming de Animes e Filmes
                    </h1>
                    <p class="hero-subtitle">
                        Milhares de animes, filmes e s√©ries dispon√≠veis para assistir online gratuitamente. Underground, Visceral, Democr√°tico.
                    </p>
                    <div class="hero-actions">
                        <button class="btn btn-primary" id="hero-play-btn">
                            <i class="ki-filled ki-play"></i>
                            Assistir Agora
                        </button>
                        <button class="btn btn-secondary" id="hero-info-btn">
                            <i class="ki-filled ki-search-list"></i>
                            Explorar Cat√°logo
                        </button>
                    </div>
                    <div class="hero-stats">
                        <div class="stat">
                            <span class="stat-value">1000+</span>
                            <span class="stat-label">T√≠tulos</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">2</span>
                            <span class="stat-label">Drives</span>
                        </div>
                        <div class="stat">
                            <span class="stat-value">HD</span>
                            <span class="stat-label">Qualidade</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tabs Navigation -->
        <div class="tabs-navigation">
            <button class="tab-btn active" data-tab="all">
                <i class="ki-filled ki-category"></i>
                Todos
            </button>
            <button class="tab-btn" data-tab="animes">
                <i class="ki-filled ki-picture"></i>
                Animes
            </button>
            <button class="tab-btn" data-tab="filmes">
                <i class="ki-filled ki-video"></i>
                Filmes
            </button>
            <button class="tab-btn" data-tab="series">
                <i class="ki-filled ki-monitor-mobile"></i>
                S√©ries
            </button>
        </div>

        <!-- Continue Watching Section -->
        <section class="content-section hidden" id="continue-watching">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="ki-filled ki-timer"></i>
                    Continue Assistindo
                </h2>
            </div>
            <div class="productions-grid" id="continue-carousel"></div>
        </section>

        <!-- Featured Section -->
        <section class="content-section" id="featured-section">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="ki-filled ki-star"></i>
                    Destaques
                </h2>
                <a class="section-link" href="#catalogo">Ver Todos</a>
            </div>
            <div class="productions-grid" id="featured-grid"></div>
        </section>

        <!-- Animes Section -->
        <section class="content-section" id="animes">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="ki-filled ki-picture"></i>
                    Animes & Desenhos
                </h2>
            </div>
            <div class="productions-grid" id="animes-carousel"></div>
        </section>

        <!-- Filmes Section -->
        <section class="content-section" id="filmes">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="ki-filled ki-video"></i>
                    Filmes
                </h2>
            </div>
            <div class="productions-grid" id="filmes-carousel"></div>
        </section>

        <!-- S√©ries Section -->
        <section class="content-section" id="series">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="ki-filled ki-monitor-mobile"></i>
                    S√©ries
                </h2>
            </div>
            <div class="productions-grid" id="series-carousel"></div>
        </section>
    </main>

    <!-- Chat AI Sidebar -->
    <aside class="chat-sidebar" id="chat-sidebar">
        <div class="chat-header">
            <div class="chat-avatar">
                <img alt="Derona - Assistente Bitaca" class="avatar-img" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Derona&backgroundColor=C41E3A">
            </div>
            <div class="chat-info">
                <h3 class="chat-title">Derona - Bitaca AI</h3>
                <div class="chat-status online">
                    <i class="ki-filled ki-check-circle"></i>
                    <span>Online</span>
                </div>
            </div>
            <button aria-label="Minimizar chat" class="chat-toggle" id="chat-toggle">
                <i class="ki-filled ki-arrow-right"></i>
            </button>
        </div>

        <div class="chat-messages" id="chat-messages">
            <div class="chat-message bot-message">
                <div class="message-avatar">
                    <img alt="Bot" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Derona&backgroundColor=C41E3A">
                </div>
                <div class="message-content">
                    <div class="message-bubble">
                        Eae parceiro! üé¨ Sou a Derona do Bitaca Play. Como posso te ajudar a encontrar seu pr√≥ximo anime ou filme favorito?
                    </div>
                    <span class="message-time">Agora</span>
                </div>
            </div>
        </div>

        <div class="chat-suggestions">
            <button class="suggestion-btn" data-suggestion="Mostre animes populares">
                <i class="ki-filled ki-picture"></i>
                Animes populares
            </button>
            <button class="suggestion-btn" data-suggestion="Recomende filmes de a√ß√£o">
                <i class="ki-filled ki-video"></i>
                Filmes de a√ß√£o
            </button>
            <button class="suggestion-btn" data-suggestion="S√©ries de aventura">
                <i class="ki-filled ki-monitor-mobile"></i>
                S√©ries de aventura
            </button>
        </div>

        <div class="chat-typing-indicator hidden" id="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <div class="chat-input-container">
            <div class="chat-input-wrapper">
                <textarea
                    aria-label="Digite sua mensagem"
                    class="chat-input"
                    id="chat-input"
                    maxlength="500"
                    placeholder="Pergunte sobre os filmes..."
                    rows="1"
                ></textarea>
                <button aria-label="Gravar √°udio" class="voice-btn" id="voice-btn" title="Gravar √°udio">
                    <i class="ki-filled ki-microphone-2"></i>
                </button>
                <button aria-label="Enviar mensagem" class="send-btn" disabled id="send-btn">
                    <i class="ki-filled ki-send"></i>
                </button>
            </div>
        </div>
    </aside>
</div>

<!-- Mobile Chat FAB -->
<button aria-label="Abrir chat" class="mobile-chat-fab" id="mobile-chat-fab">
    <i class="ki-filled ki-messages"></i>
    <span class="fab-badge" id="fab-badge">1</span>
</button>

<!-- Search Overlay -->
<div class="search-overlay" id="search-overlay">
    <div class="search-container">
        <input
            aria-label="Buscar conte√∫do"
            autocomplete="off"
            class="search-input"
            id="search-input"
            placeholder="Buscar animes, filmes ou s√©ries..."
            type="text"
        >
        <button aria-label="Fechar busca" class="search-close" id="search-close">
            <i class="ki-filled ki-cross"></i>
        </button>
        <div class="search-results" id="search-results"></div>
    </div>
</div>

<!-- Video Player Modal -->
<div class="player-modal" id="player-modal">
    <div class="player-overlay" id="player-overlay"></div>
    <div class="player-wrapper">
        <button aria-label="Fechar player" class="player-close" id="player-close">
            <i class="ki-filled ki-cross"></i>
        </button>
        <div class="player-container" id="player-container">
            <video
                class="player-video"
                controls
                id="player-video"
                playsinline
            ></video>
        </div>
        <div class="player-info" id="player-info">
            <!-- Player info ser√° preenchido via JS -->
        </div>
    </div>
</div>

<!-- Loading Spinner -->
<div class="loading-spinner" id="loading-spinner">
    <div class="spinner"></div>
    <p>Carregando conte√∫do...</p>
</div>

<!-- Toast Container -->
<div aria-live="polite" class="toast-container" id="toast-container"></div>

<!-- Footer -->
<footer class="footer">
    <div class="footer-container">
        <div>
            <div class="footer-logo">
                <svg height="60" viewBox="0 0 120 60" width="120">
                    <polygon fill="#F5DEB3" points="60,5 72,15 72,25 48,25 48,15"/>
                    <text fill="#F5DEB3" font-family="Staatliches" font-size="18" x="20" y="45">BITACA</text>
                    <text fill="#F5DEB3" font-family="Pacifico" font-size="10" x="30" y="55">Play</text>
                </svg>
            </div>
            <p class="footer-tagline">
                "Streaming de animes e filmes<br>para todos"
            </p>
        </div>

        <div>
            <h4 class="footer-title">Navega√ß√£o</h4>
            <ul class="footer-links">
                <li><a href="#animes">Animes</a></li>
                <li><a href="#filmes">Filmes</a></li>
                <li><a href="#series">S√©ries</a></li>
                <li><a href="https://chat.abitaca.com.br">Chat AI</a></li>
            </ul>
        </div>

        <div>
            <h4 class="footer-title">Cat√°logo</h4>
            <ul class="footer-links">
                <li><a href="#animes">Drive 0: Animes & Desenhos</a></li>
                <li><a href="#filmes">Drive 1: Filmes & S√©ries</a></li>
            </ul>
        </div>

        <div>
            <h4 class="footer-title">Redes Sociais</h4>
            <div class="footer-social">
                <a aria-label="Instagram" class="social-btn" href="https://www.instagram.com/abitacacb/" rel="noopener noreferrer" target="_blank">
                    <i class="ki-filled ki-instagram"></i>
                </a>
                <a aria-label="Facebook" class="social-btn" href="https://www.facebook.com/abitacacb/" rel="noopener noreferrer" target="_blank">
                    <i class="ki-filled ki-facebook"></i>
                </a>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        <p>¬© 2025 Bitaca Play | Streaming</p>
        <p>Underground, Visceral, Democr√°tico</p>
    </div>
</footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<!-- Firebase Configuration -->
<script type="module">
    // Firebase config ser√° importado pelos m√≥dulos
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';

    const firebaseConfig = {
        apiKey: "AIzaSyBSkRy1LyKbBXvyvoOCZx5t0bIDldTityk",
        authDomain: "abitaca-8451c.firebaseapp.com",
        projectId: "abitaca-8451c",
        storageBucket: "abitaca-8451c.firebasestorage.app",
        messagingSenderId: "31455523643",
        appId: "1:31455523643:web:3f8590a2e5181ee9ef3d1e",
        measurementId: "G-3RHX80J2V7"
    };

    window.firebaseApp = initializeApp(firebaseConfig);
</script>

<!-- Auth & Protection -->
<script type="module">
    import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';
    import { AnimeZeyAPI } from './assets/js/animezey-api.js';

    const auth = getAuth(window.firebaseApp);

    // Check authentication
    onAuthStateChanged(auth, (user) => {
        if (!user) {
            // Not logged in, redirect to login with current page as redirect parameter
            const currentUrl = window.location.pathname + window.location.search;
            window.location.href = '/login.html?redirect=' + encodeURIComponent(currentUrl);
        } else {
            console.log('User logged in:', user.email);
            // User is authenticated, initialize app
            window.bitacaUser = user;
        }
    });

    // Initialize AnimeZey API
    window.animezeyAPI = new AnimeZeyAPI();

    // Logout button
    document.getElementById('logout-btn')?.addEventListener('click', async () => {
        if (confirm('Deseja realmente sair?')) {
            try {
                await signOut(auth);
                window.location.href = '/login.html';
            } catch (error) {
                console.error('Logout error:', error);
                alert('Erro ao sair. Tente novamente.');
            }
        }
    });
</script>

<!-- App Scripts -->
<script src="assets/js/advanced-video-player.js" type="module"></script>
<script src="assets/js/smart-search-engine.js" type="module"></script>
<script src="assets/js/viewing-analytics.js" type="module"></script>
<script src="assets/js/play.js" type="module"></script>

<!-- UI Interactions -->
<script>
    // Mobile chat toggle
    const mobileChatFab = document.getElementById('mobile-chat-fab');
    const chatSidebar = document.getElementById('chat-sidebar');

    mobileChatFab?.addEventListener('click', () => {
        chatSidebar?.classList.toggle('active');
    });

    // Chat toggle button
    const chatToggle = document.getElementById('chat-toggle');
    chatToggle?.addEventListener('click', () => {
        chatSidebar?.classList.toggle('minimized');
    });

    // Search overlay
    const searchBtn = document.getElementById('search-btn');
    const searchOverlay = document.getElementById('search-overlay');
    const searchClose = document.getElementById('search-close');
    const searchInput = document.getElementById('search-input');

    searchBtn?.addEventListener('click', () => {
        searchOverlay?.classList.add('active');
        searchInput?.focus();
    });

    searchClose?.addEventListener('click', () => {
        searchOverlay?.classList.remove('active');
    });

    // ESC key to close search
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            searchOverlay?.classList.remove('active');
        }
    });

    // 3D mode button
    const btn3D = document.getElementById('3d-btn');
    btn3D?.addEventListener('click', () => {
        window.location.href = 'https://play-3d.abitaca.com.br';
    });

    // Tab navigation
    const tabBtns = document.querySelectorAll('.tab-btn');
    tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            // Remove active from all tabs
            tabBtns.forEach(b => b.classList.remove('active'));
            // Add active to clicked tab
            btn.classList.add('active');

            const tab = btn.dataset.tab;
            const sections = document.querySelectorAll('.content-section');

            if (tab === 'all') {
                sections.forEach(s => s.classList.remove('hidden'));
            } else {
                sections.forEach(s => {
                    if (s.id === tab) {
                        s.classList.remove('hidden');
                    } else if (s.id !== 'featured-section' && s.id !== 'continue-watching') {
                        s.classList.add('hidden');
                    }
                });
            }
        });
    });

    // Chat input auto-resize
    const chatInput = document.getElementById('chat-input');
    const sendBtn = document.getElementById('send-btn');

    chatInput?.addEventListener('input', function() {
        this.style.height = 'auto';
        this.style.height = Math.min(this.scrollHeight, 120) + 'px';

        // Enable/disable send button
        if (sendBtn) {
            sendBtn.disabled = this.value.trim().length === 0;
        }
    });

    // Navbar scroll effect
    const navbar = document.getElementById('navbar');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 100) {
            navbar?.classList.add('scrolled');
        } else {
            navbar?.classList.remove('scrolled');
        }
    });

    // Suggestion chips
    const suggestionBtns = document.querySelectorAll('.suggestion-btn');
    suggestionBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const suggestion = btn.dataset.suggestion;
            if (chatInput) {
                chatInput.value = suggestion;
                chatInput.dispatchEvent(new Event('input'));
                chatInput.focus();
            }
        });
    });

    // Console welcome message
    console.log('%cüé¨ Bitaca Play', 'font-size: 24px; font-weight: bold; color: #C41E3A;');
    console.log('%cUnderground | Visceral | Democr√°tico', 'font-size: 14px; color: #2D5016;');
</script>

</body>
</html>
